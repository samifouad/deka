name: PHPX Docs Gates

on:
  push:
  pull_request:

jobs:
  module_doc_coverage:
    name: Module Doccomment Coverage
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "22"
      - name: Validate php_modules doccomment coverage
        run: scripts/check-module-docs.sh

  release_build_and_docs:
    name: Release Build + Docs Pipeline
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "22"
      - uses: dtolnay/rust-toolchain@stable
      - name: Run release build + docs publish pipeline
        env:
          DEKA_WEBSITE_ROOT: /tmp/deka-website
          DEKA_DOCS_OUT: /tmp/deka-docs/content/docs
        run: scripts/build-release-docs.sh
