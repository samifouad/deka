---
title: "Auth modules"
description: "Runtime auth primitives for PHPX applications."
---

PHPX runtime auth primitives live in `php_modules` and are imported explicitly.

## Modules

- `crypto`
  - `random_bytes_result`, `random_hex`, `uuid_v4`
  - `sha256_hex`, `hmac_sha256_hex`, `hmac_sha256_bytes`
  - `secure_compare`
- `jwt`
  - `sign(payload, secret, options)`
  - `verify(token, secret, options)`
  - validates `exp`, `nbf`, `iat`, and optional `iss` / `aud`
- `cookies`
  - `all`, `has`, `get`
  - `build_set_cookie`, `set_header`, `clear_header`
- `auth`
  - `pkce_pair`
  - `new_state`, `new_nonce`
  - `sign_oauth_state`, `verify_oauth_state`

## Example

```php
import { pkce_pair, new_state, new_nonce } from 'auth'
import { sign, verify } from 'jwt'
import { build_set_cookie } from 'cookies'

$pkce = pkce_pair()
$state = new_state()
$nonce = new_nonce()
$token = sign({ sub: 'user-1' }, 'dev-secret', [ 'exp_in' => 300 ])

$cookie = build_set_cookie('session', $token->value, [
  'path' => '/',
  'http_only' => true,
  'secure' => true,
  'same_site' => 'Lax',
])
```
