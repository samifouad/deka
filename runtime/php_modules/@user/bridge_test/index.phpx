struct Person {
    $name: string;
    $age: int = 0;
}

/// docid: phpx/modules/takes_option()
/// <Function name="takes_option">
///   <Description>PHPX standard module function `takes_option` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function takes_option(Option<int> $value): int {
    return match ($value) {
        \Option::Some => $value.value,
        \Option::None => 0,
    };
}

/// docid: phpx/modules/returns_option()
/// <Function name="returns_option">
///   <Description>PHPX standard module function `returns_option` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function returns_option(int $value): Option<int> {
    if ($value > 0) {
        return \Option::Some($value);
    }
    return \Option::None;
}

/// docid: phpx/modules/takes_object()
/// <Function name="takes_object">
///   <Description>PHPX standard module function `takes_object` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function takes_object(Object<{ name: string, age?: int }> $user): string {
    $age = isset($user.age) ? (string)$user.age : 'na';
    return $user.name . ':' . $age;
}

/// docid: phpx/modules/takes_struct()
/// <Function name="takes_struct">
///   <Description>PHPX standard module function `takes_struct` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function takes_struct(Person $person): string {
    return $person.name . ':' . (string)$person.age;
}

/// docid: phpx/modules/returns_result()
/// <Function name="returns_result">
///   <Description>PHPX standard module function `returns_result` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function returns_result(int $value): Result<int, string> {
    if ($value > 0) {
        return \Result::Ok($value);
    }
    return \Result::Err('bad');
}

/// docid: phpx/modules/echo_result()
/// <Function name="echo_result">
///   <Description>PHPX standard module function `echo_result` from `modules`.</Description>
///   <ReturnType type="mixed" />
/// </Function>
export function echo_result(Result<int, string> $value): int {
    return match ($value) {
        \Result::Ok => $value.value,
        \Result::Err => -1,
    };
}
