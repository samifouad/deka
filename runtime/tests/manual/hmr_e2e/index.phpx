/*
TEST: HMR browser state preservation
Covers: html patching updates changed content without hard reload, while preserving focus, selection, and scroll.
*/

import { renderToString } from 'component/dom'

function App($props) {
    return <div>
        <h1>HMR E2E Fixture</h1>
        <input id="name" name="name" value="abcdefghi" />
        <p id="version">Version: {$props.version}</p>
        <div style="height:2400px"></div>
    </div>
}

$version = 'v1'
$body = renderToString(<App version={$version} />)

if (function_exists('header')) {
    header('Content-Type: text/html; charset=utf-8')
}

echo "<!doctype html>\n"
echo "<html><head><meta charset=\"utf-8\"><title>HMR E2E</title></head><body>\n"
echo "<div id=\"app\">{$body}</div>\n"
echo "<script>window.__hmrNonce=window.__hmrNonce||Math.random().toString(36).slice(2)</script>\n"
echo "</body></html>\n"
