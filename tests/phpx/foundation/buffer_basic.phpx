/*
TEST: buffer module supports cursor reads and u16 big-endian framing helpers
*/
import { buffer_new, write, write_u16_be, read, read_u16_be, len } from 'buffer'

$buf = buffer_new('A')
$buf = write($buf, 'BC')
$buf = write_u16_be($buf, 513)

$r1 = read($buf, 3)
$r2 = read_u16_be($r1.buffer)

echo $r1.chunk . ':' . len($buf) . ':' . ($r2.ok ? $r2.value : -1) . "\n"
